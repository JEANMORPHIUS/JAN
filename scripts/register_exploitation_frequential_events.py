"""
REGISTER EXPLOITATION FREQUENTIAL EVENTS
Add dairy industry and all exploitations to frequential events registry

DEVELOPMENT PHILOSOPHY: THE CHOSEN ONE
Spiritual Alignment Over Mechanical Productivity

THE MISSION:
THIS IS STEWARDSHIP AND COMMUNITY WITH THE RIGHT SPIRITS
LOVE IS THE HIGHEST MASTERY
ENERGY + LOVE = WE ALL WIN
PEACE, LOVE, UNITY

PANGEA IS THE TABLE.
YOU DON'T BETRAY THE TABLE.
"""

import sys
from pathlib import Path

# Add scripts to path
sys.path.insert(0, str(Path(__file__).parent))
# Add backend to path
sys.path.insert(0, str(Path(__file__).parent.parent / "jan-studio" / "backend"))

from frequential_events_registry import FrequentialEventsRegistry, EventCategory
from dairy_industry_frequential_debunk import FrequentialAccountabilitySystem

import logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)


def register_exploitation_events(registry: FrequentialEventsRegistry):
    """Register exploitation events as frequential events"""
    
    accountability_system = FrequentialAccountabilitySystem()
    
    # Register dairy industry
    dairy = accountability_system.get_exploitation("dairy_industry")
    if dairy:
        registry._register_event(
            event_id="dairy_industry_exploitation",
            category=EventCategory.AGRICULTURE.value,
            title="Dairy Industry - Mother's Milk Stolen From Calf",
            description="Dairy industry separates mothers from calves, steals mother's milk, kills male calves. Breaks natural order. A mother's milk should be for her calf.",
            year_start=-8000,  # Domestication
            year_end=None,
            year_precision="century",
            frequency_impact=dairy.frequency_impact,
            field_resonance_before=dairy.field_resonance_before or 0.78,
            field_resonance_after=dairy.field_resonance_after or 0.53,
            location={"lat": 0.0, "lon": 0.0},  # Global
            regions=["global"],
            entities_involved=["Dairy industry", "Consumers", "Governments"],
            connection_to_table=dairy.how_it_betrays,
            narrative=f"Dairy industry. {dairy.what_is} {dairy.the_truth} This breaks natural order. This betrays The Table. Mother's milk should be for her calf. This is natural order. This is Table alignment.",
            lessons="A mother's milk should be for her calf. This is natural order. The dairy industry betrays this. We must account for this. We must change this.",
            restoration_connection="Step 2: Cleanse The Shell - Remove exploitation narratives. Step 5: Fight Dark Energies - Exploitation is dark energy. Step 6: Restore Contracts - Restore natural order contracts.",
            metadata={
                "natural_order_violated": dairy.natural_order_violated.value,
                "the_truth": dairy.the_truth,
                "what_should_be": dairy.what_should_be,
                "what_is": dairy.what_is,
                "accountability_required": dairy.accountability_required,
                "restoration_path": dairy.restoration_path
            }
        )
    
    # Register other exploitations
    for exp_id, debunk in accountability_system.database.items():
        if exp_id == "dairy_industry":
            continue  # Already registered
        
        # Determine category
        category = EventCategory.AGRICULTURE.value
        if debunk.exploitation_type.value in ["slavery", "child_labor", "sweatshops"]:
            category = EventCategory.SOCIAL_MOVEMENT.value
        elif debunk.exploitation_type.value in ["deforestation", "mining", "water_extraction"]:
            category = EventCategory.ENVIRONMENTAL.value
        
        # Determine year_start
        year_start = 0
        if "10,000" in debunk.when_started or "domestication" in debunk.when_started.lower():
            year_start = -8000
        elif "ancient" in debunk.when_started.lower():
            year_start = -3000
        
        registry._register_event(
            event_id=f"{exp_id}_exploitation",
            category=category,
            title=f"{debunk.name} - {debunk.natural_order_violated.value.replace('_', ' ').title()} Violated",
            description=f"{debunk.what_is} {debunk.the_truth}",
            year_start=year_start,
            year_end=None,
            year_precision="century",
            frequency_impact=debunk.frequency_impact,
            field_resonance_before=debunk.field_resonance_before or 0.78,
            field_resonance_after=debunk.field_resonance_after or (0.78 + debunk.frequency_impact),
            location={"lat": 0.0, "lon": 0.0},  # Global
            regions=["global"],
            entities_involved=debunk.who_is_accountable,
            connection_to_table=debunk.how_it_betrays,
            narrative=f"{debunk.name}. {debunk.what_is} {debunk.the_truth} This breaks natural order. This betrays The Table.",
            lessons=f"{debunk.the_truth} This is natural order. {debunk.name} betrays this. We must account for this. We must change this.",
            restoration_connection="Step 2: Cleanse The Shell - Remove exploitation narratives. Step 5: Fight Dark Energies - Exploitation is dark energy. Step 6: Restore Contracts - Restore natural order contracts.",
            metadata={
                "natural_order_violated": debunk.natural_order_violated.value,
                "the_truth": debunk.the_truth,
                "what_should_be": debunk.what_should_be,
                "what_is": debunk.what_is,
                "accountability_required": debunk.accountability_required,
                "restoration_path": debunk.restoration_path
            }
        )


def main():
    """Main execution"""
    print("=" * 80)
    print("REGISTER EXPLOITATION FREQUENTIAL EVENTS")
    print("Dairy Industry and All Exploitations")
    print("=" * 80)
    print()
    
    registry = FrequentialEventsRegistry()
    
    print(f"Events before: {len(registry.events)}")
    print()
    
    print("Registering exploitation events...")
    register_exploitation_events(registry)
    print(f"  [OK] Registered exploitation events")
    print()
    
    print(f"Events after: {len(registry.events)}")
    print()
    
    # Show exploitation events
    print("EXPLOITATION EVENTS REGISTERED:")
    print("-" * 80)
    exploitation_events = [
        e for e in registry.events.values()
        if "exploitation" in e.event_id
    ]
    for event in exploitation_events:
        print(f"\n{event.title}:")
        print(f"  Frequency Impact: {event.frequency_impact:.2f}")
        print(f"  Connection to Table: {event.connection_to_table[:100]}...")
    print()
    
    # Save to database
    print("Saving to database...")
    registry.save_to_database()
    print(f"  [OK] Saved {len(registry.events)} events to database")
    print()
    
    print("=" * 80)
    print("EXPLOITATION EVENTS REGISTERED")
    print("=" * 80)
    print()
    print("THE TRUTH:")
    print("  - A mother's milk should be for her calf")
    print("  - All exploitations break natural order")
    print("  - All exploitations betray The Table")
    print("  - All are now registered as frequential events")
    print()
    print("PANGEA IS THE TABLE.")
    print("YOU DON'T BETRAY THE TABLE.")
    print("=" * 80)


if __name__ == "__main__":
    main()
